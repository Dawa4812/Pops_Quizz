{% extends 'base.html' %}

{% load static %}

{% block content %}
	<div class="col-lg-8 col-md-8 col-sm-8 col-xs-8 background_body typo_generale" onload="timer()">
		<h1>{{ player.game.name }}</h1>
	  	<h3>{{ form.name }}</h3>

	  	{% if form.author is not None %}
	  		<h6>Créé par {{ form.author.login }}</h6>
	  	{% else %}
	  		<h6>Créé par teampopsquizz</h6>
	  	{% endif %}
		{% if game.is_limited_time %}
		<div class="sticky rounded bg-gradient-2 text-white shadow p-5 text-center mb-5">
			<p class="mb-0 font-weight-bold text-uppercase">Temps restant</p>
			<input type="hidden" id="timer" value="{{game.timer_sec}}">
			<input type="hidden" id="date_limit" value="{{game.date_limite}}">
			<input type="hidden" id="correction_url" value="{% url 'Quizz:correction' player.id %}">
			<p id="clock" class="countdown pt-4"></p>
			<div class="progress">
				<div class="progress-bar progress-bar-striped progress-bar-animated bg-success" id="progress-bar" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%"></div>
			</div>
		</div>
		{% endif %}

  		<form id="form_answers" action="{% url 'Quizz:correction' player.id %}" method="post">

			<input type="hidden" name="idplayer" id="idplayer" value="{{ player.id }}">
  			{% csrf_token %}

			{% for q in form.questions %}
				
				<fieldset class="fdst_border"><legend class="lgd_style" id="question">{{ q.question.label }}</legend>
					<div class="row">

						{% if q.question.answer_type.type == "INPUT" %}

					  	{% if q.answers.size == 0 %}
							Pas de réponse
					  	{% else %}
							{% with q.answers|first as answer %}
						  		<div class="col">
									<input type="text" class="form-control style_form" id="answer{{ answer.id }}" name="check{{ answer.id }}" placeholder="">
						  		</div>
							{% endwith %}
						{% endif %}

						{% elif q.question.answer_type.type == "QCM" %}

							{% for a in q.answers %}
							  	<div class="col">
							  		<div class="form-check">
								  		<input class="form-check-input" type="checkbox" id="answer{{ a.id }}" name="qcm{{ q.question.id }}">
								        <label class="form-check-label" for="answer{{ a.id }}">{{ a.value }}</label>
							    	</div>
							  	</div>
						  	{% empty %}
								Pas de réponse
							{% endfor %}


						{% elif q.question.answer_type.type == "UNIQUE_ANSWER" %}

							{% for a in q.answers %}
					  	<div class="col">

					  		<div class="form-check">
					  		
								<input class="form-check-input" type="radio" name="qradio{{ q.question.id }}" id="answer{{ a.id }}" value="{{ a.id }}">
					      		<label class="form-check-label" for="answer{{ a.id }}">
					            {{ a.value }}
					      		</label>

					      	</div>
							
					  	</div>
					  	{% empty %}
							Pas de réponse
						{% endfor %}


						{% else %}

						Type non pris en charge
						
						{% endif %}

					</div>
				
				
				</fieldset>
			{% empty %}
				Pas de questions
			{% endfor %}

			<br>
			<div class="droite">
				<button type="submit" id="subbtn" class="btn connectBtn">VALIDER</button>
				<button type="reset" id="resbtn" class="btn connectBtn">ANNULER</button>
			</div>

		</form>
	</div>
{% endblock %}

{% block js_per_page %}
	<script type="text/javascript" src="{% static "js/gamerun.js"%}">
	</script>
{% endblock %}
